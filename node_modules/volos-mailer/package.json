{
  "name": "volos-mailer",
  "version": "0.0.8",
  "description": "Volos Mailer Connector",
  "main": "nodemailerConnector.js",
  "dependencies": {
    "nodemailer": "^1.0.3",
    "volos-connectors-common": "^0.0.9",
    "lodash": "^2.4.1",
    "q": "^1.0.1"
  },
  "devDependencies": {},
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/apigee-127/volos-connectors.git"
  },
  "keywords": [
    "nodemailer",
    "mailer"
  ],
  "author": {
    "name": "Randy Solton",
    "email": "rsolton@apigee.com"
  },
  "license": "MIT",
  "bugs": {
    "url": "https://github.com/apigee-127/volos-connectors/issues"
  },
  "homepage": "https://github.com/apigee-127/volos-connectors",
  "readme": "# Volos Mailer connector\n\nThe Volos Mailer connector lets you send email messages through a RESTful API. It is one of the Volos Node.js modules from Apigee. The module is designed to work on Apigee Edge but can be run anywhere Node.js applications can run.  You can use this module without any dependency on Apigee.\n\n### Quick example\n\nTo send an email with this connector, simply send an HTTP request to the ``/mail`` resource. A set of query parameters are used to specify the parts of the email such as from, to, subject, and message. \n\nFor example, you might send an email through the connector like this:\n\n```\ncurl 'http://localhost:9089/mail?from=me@example.com&to=you@example.com&subject=Hello%20world&html=<b>Just%20saying%20hello!</b>'\n```\n\nAlternatively, you can send email using POST through the connector like this:\n\n```\ncurl -X POST http://localhost:9057/mail -d '{\"from\": \"me at the corner.com<blah@mememe.com>\", \"to\": \"someguy@somecompany.com\", \"subject\": \"Just% Saying Goodbye\", \"html\": \"<b>yes sir</b>\"}' -H 'Content-Type: application/json\n```\n\n# Installation\n\nThe ``volos-mailer`` module is designed for Node.js and is available through npm:\n\n```\n$ npm install volos-mailer\n```\n\n# Usage\n\nThere are two examples below, one basic example and one that uses the ``avault`` (Apigee Vault) Node.js module, which is a secure local storage module. Apigee Vault is used to encrypt sensitive login credentials sent to the backend mail service.\n\n### Simple example without Apigee Vault\n\nThe example below shows a simple usage of the ``volos-mailer`` connector using the ``http`` module to proxy requests to the connector.  \n\n>In this example, credentials and the mail server endpoint are specified in plaintext. This is not a best practice.\n\n\n```\nvar nodemailerConnector = require('volos-mailer');\nvar http = require('http');\n\nvar profile = {\n  host: 'mymailserver.example.com',\n  port: '5432',\n  auth: {\"user\":\"myusername\",\"pass\":\"mypass\"}\n};\n\n    var nodemailerConnectorObject = new nodemailerConnector.NodemailerConnector({\"profile\": profile});\n\n    var svr = http.createServer(function (req, resp) {\n      nodemailerConnectorObject.dispatchRequest(req, resp);\n    });\n\n    svr.listen(9089, function () {\n        console.log(nodemailerConnectorObject.applicationName + ' node server is listening');\n    });\n\n```\n\n\n### Simple example using the Apigee Vault for local secure storage\n\nThis example shows the usage of the ``avault`` module to provide a secure local storage option for credentials and endpoint configuration.  \n\nThis example assumes you have configured a vault and loaded a configuration profile with a key '*my_profile_key*'. See the section \"[Mailer connection profile](#mailer-connection-profile)\" below for a quick example. For a complete description of the ``avault`` module see the [Apigee Vault page on GitHub](https://github.com/apigee-127/avault). \n\n```\nvar mailerConnector = require('volos-mailer');\nvar http = require('http');\nvar vault = require('avault').createVault(__dirname);\n\nvar mailerConnectorObject;\n\nvault.get('my_profile_key', function (profileString) {\n  if (!profileString) {\n    console.log('Error: required vault not found.');\n  } else {\n    var profile = JSON.parse(profileString);\n\n    var svr = http.createServer(function (req, resp) {\n      mailerConnectorObject.dispatchRequest(req, resp);\n    });\n\n    svr.listen(9089, function () {\n      mailerConnectorObject = new mailerConnector.mailerConnector({\"profile\": profile});\n      console.log(nodemailerConnectorObject.applicationName + ' node server is listening');\n    });\n  }\n});\n```\n\n\n# Getting started with your app\n\nTo use this connector you need to configure the Volos Mailer connection profile, start the Node.js server, and then you can start sending emails.\n\n### Mailer connection profile\n\nThis connector is requires the Node.js module called ``nodemailer``. This module allows you to connect directly to an SMTP server or to some \"well known\" mail services, like Gmail and Hotmail. \n\nYou can find a complete list of these connection parameters at https://www.npmjs.org/package/nodemailer.\n\nTo configure the connection, you'll need this information:\n\n* **host** - The hostname of the SMTP server. \n* **port** - The port number for the SMTP server. (default: 25; only needed if you are connecting to a SMPT server)\n* **auth** - A JSON object with two elements:\n    - **user** - The username you use for your email service.\n    - **pass** - The password for you email service. \n\n**Example:**\nIf you are connecting directly to a SMTP server, follow this pattern:\n```\nvar profile = {\n  host: 'mymailserver.example.com',\n  port: '5432',\n  auth: {\"user\":\"myusername\",\"pass\":\"mypass\"}\n};\n```\n\n**Example:**\nIf you are connecting directly through one of the well known mail services, follow this pattern:\n```\nvar profile = {\n  host: 'Gmail',\n  auth: {\"user\":\"myusername\",\"pass\":\"mypass\"}\n};\n```\n\n### Optional: Encrypting the connection profile with Apigee Vault \n\nThe ``avault`` module provides local, double-key encrypted storage of sensitive information such as credentials and system endpoints.  This provides an option to store these kinds of data in a format other than `text/plain`.\n\nIn order to insert a value into the vault a command-line tool is provided called `vaultcli`.  This tool comes with the `avault` module.  Here's an example:\n\n```\n    ./node_modules/avault/vaultcli.js --verbose --value='{\"host\":\"my-smtp-server-address\", \"port\": \"my-smtp-server-port\", \"auth\": {\"user\": \"my-email username\", \"pass\":\"my-email-password\"}}' my-profile-name\n```\n\nIf you are using one of the well known email services, the command-line usage follows this pattern:\n\n```\n    ./node_modules/avault/vaultcli.js --verbose --value='{\"host\":\"Gmail\",  \"auth\": {\"user\": \"my-gmail-username\", \"pass\":\"my-gmail-password\"}}' my-vault-name\n```\n\n>These are the same keys that are required in the plaintext version of the profile.  If this command completes successfully you will find two new files: `store.js` and `keys.js`. Place them in the root directory of the ``volos-mailer`` module. \n\nFor more detailed usage of the `avault` module refer to the [Apigee Vault page on GitHub](https://github.com/apigee-127/avault). \n\n### Sending an email\n\nTo send an email through the API, simply send a request to the ``/mail`` resource and provide these **required** query parameters:\n\n* **from** - Who the email is from.\n* **to** - The email address to send to.\n* **subject** - Text that will appear in the email Subject line.\n* **html** or **text** -- The body of the message (can be either in HTML or plain text formats). \n\nRemember to escape invalid URL characters, like white space. For example:\n\n```\ncurl 'http://localhost:9057/mail?from=myemail@gmail.com&to=youremail@gmail.com&subject=Hello%20world&html=<b>Just%20saying%20hello!</b>'\n```\n\n> **Tip:** You can also specify any of these optional query parameters:\n\n'cc', 'bcc', 'replyTo', 'inReplyTo', 'references', 'generateTextFromHTML', 'envelope', 'messageId', 'date', 'encoding', 'charset'\n\nA successful response looks something like this:\n\n```\nMessage sent: 250 2.0.0 OK 1405104395 d4sm8260652igc.5 - gsmtp\n{\n    \"message\": \"250 2.0.0 OK 1405104395 d4sm8260652igc.5 - gsmtp\",\n    \"messageId\": \"c4864d7712f67066f79962191344e4@my-macbook-air.local\"\n}\n```\n\nFor more information about Nodemailer, see the [Nodemailer page on GitHub](https://github.com/andris9/Nodemailer).\n\n# License\n\nMIT\n\n",
  "readmeFilename": "README.md",
  "_id": "volos-mailer@0.0.8",
  "_from": "volos-mailer@0.0.8"
}
